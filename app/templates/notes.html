{%extends 'layout.html'%} {% block content %}

<form id='coursenotes'>
    <label for='name'><h3>Enter course name</h3></label>
    <input id='name' type='text' name='course_name'>
    <button type="submit">search</button>
</form>
<ul id='notes-list'>
</ul>
<script>
    window.addEventListener('load', () => {
        let list = document.querySelector('#notes-list')
        let form = document.querySelector('#coursenotes');
        form.addEventListener('submit', e => {
            e.preventDefault();
            const name = form.elements['course_name'].value;
            console.log(name)

            /*let payload = JSON.stringify({
                    'course_name': name
                })
                let data = {
                    
                    headers: {
                        "Content-Type": 'application/json;charset=utf=8'
                    },
                    body: JSON.stringify(payload)
                }*/

            fetch('/course_notes',{
                method:'POST',
                headers:{
                'Content-Type':'application/json',
                },
                body:JSON.stringify({'course_name':name})
                    }
                )
                .then(resp => resp.json())
                .then(data => {
                    if (data['error']) {
                        console.log(data['error'])
                    } else {
                        console.log(data)
                        let notes = data;
                        notes.forEach(el => {
                            let item = document.createElement('li')
                            let view = document.createElement('a')

                            
                            view.href = `https://drive.google.com/file/d/${el.gid}/view`
                            view.innerHTML = 'View'
                            view.target = '_blank'
                            view.type = 'application/pdf'
                            view.classList += 'view'
                            item.innerHTML = el.name
                            item.appendChild(view)
                            list.appendChild(item)



                        })
                    }

                })
        })
    })
</script>
{% endblock%}